# マイクロサービス環境下における動的ポーリング自動調整アルゴリズム

- Sorry, this README is written by Japanese only.
- Now, I won't release English version README.

## 研究背景など

- 近年，案件ごとに必要なソフトウェアなどの環境構築が容易にできることから，様々な企業でマイクロサービスを用いたシステム環境構築が盛んになっている．特に，Dockerに代表されるようなコンテナ技術を用いて，1台のPCにいくつもの仮想環境を容易に作成することができる時代になった．
- しかしその一方，監視対象になるシステムが増加するので，マイクロサービス環境に対する監視プロセスが，監視マネージャやシステムに与える負担の大きさが問題となっている．

  - 実際，日本時間の2019年8月23日に起こったAWSの障害は日本中の企業に多大な影響を与えた．

- そこで，監視マネージャやマイクロサービス環境に与える負担を軽減しようとする目的で，監視計測データの変化に応じてポーリング間隔を動的に調整する研究が行われている．

  ![](/images/cloud.png "サンプル")

- しかし，先行研究は実データではなく，人工的に生成したデータを使用していた．

- また，従来からの性能指標であったRMSEが適切な指標なのか疑問を持っている．

  ![](/images/rmse_gimon.png)

- これなら，ポーリング回数が多い方がRMSEが小さくなるのは明らか．

- そこで本研究では，実際の企業でよく使われるマイクロサービス環境であるAWS上にdockerを用いてアプリケーション・監視サーバを構築し，実際の実データに対して実験を行った．

## 使用データ

- AWS上にdockerコンテナを用いてRUBiSをビルドして，負荷をかけるサーバを立てた．
- 上と同様に，dockerを用いてPromethusをビルドして，監視サーバを立ててGUI上でも変動が観れるようにした．
- **使用データの公表に関しては結果を公に公表したのちに，載せる予定である．**

![](/images/data_get.png)

## 先行手法

- 内容

  - 今までの測定値の動きを見て，測定間隔を逐次自動調整する．
  - 測定値の変化の度合いを測定し，変化が激しいときに測定の頻度を上げるといった考え方.
  - これまでの手法の課題であった複数のハイパーパラメータのチューニングを最小限にとどめ，かつ，以前のモデルよりも良い精度を出すことに成功．

- [最新手法](https://www.doc.ic.ac.uk/~dtuncer/papers/tnsm18_gt.pdf)の主要アルゴリズムは以下の通り

  ![](/images/algo_senkou.png)

## 提案手法

### 異常検知手法

![](/images/cos_similar.png)

### ポーリング間隔調整手法

![](/images/polling_1.png)

- そして，以下の式で次のポーリング間隔を決める． ![](/images/polling_graph.png)

## 簡単な結果など

- 動的ポーリング自動調整分野において，初めて実データ(CPU使用率)に対して実験した結果を載せている．
- [最新手法](https://www.doc.ic.ac.uk/~dtuncer/papers/tnsm18_gt.pdf)が実データで使用可能なのかを確かめ，課題を明確にした．
- この分野において，確率分布を絡めた新たな手法を提案し，最新手法と比較して44%〜88%ほどポーリング回数の減少を達成． ![](/images/rmse.png) ポーリング間隔の上限設定を10[s] ~ 100[s]の間で設定した時のRMSEとポーリング間隔の推移を表した図

- ポーリング間隔の推移を図示することにより，考察をしやすくした(先行研究は図示されていなかった)

  #### 正常部分に対するポーリング間隔の推移

  ![](/images/interval_seijo.png)

### 異常部分におけるポーリング間隔の推移

![](/images/interval_ijo.png)

- この分野における従来からの性能指標であるRMSEの必要性に疑問を投げかける結果になった．

## ファイルの簡単な説明

- 中間発表で必要なソースコードをjupyter notebook形式で載せる．

### evaluation_by_rmse.py

- 線形補間して，rmseを計算するやつ．

### ipynb

- change_finder_0902.ipynb

  - Change-Finderを適用したもの

- final_report_implement_0906.ipynb

  - 確率分布を用いたポーリング調整を行ったやつ．

- sequential_update_using_distribution_method.ipynb

  - 逐次更新型で確率分布のパラメータを推定していき，分布とのズレを見るやつ．cos類似度の考えを用いている．

- SST_online.ipynb

  - 特異スペクトル変換(オンライン型)
